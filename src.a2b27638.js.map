{"version":3,"sources":["src/controls.js","src/player.js","src/map.js","src/camera.js","src/minimap.js","src/index.js","node_modules/parcel/src/builtins/hmr-runtime.js"],"names":["codes","state","left","right","forward","backward","onKey","pressed","direction","document","addEventListener","which","circle","Math","PI","Player","x","y","speed","rotateSpeed","init","info","createElement","classList","add","body","appendChild","angle","distance","map","dx","cos","dy","sin","isWall","controls","tick","rotate","move","updateInfo","innerHTML","toFixed","Map","walls","width","length","height","eyeshot","charSet","wall","floor","char","get","player","depth","hitWall","boundary","nTestX","nTestY","p","tx","ty","vy","vx","d","hypot","dot","push","bound","sorted","sort","a","b","acos","Camera","fov","screen","Array","ceiling","wall1","wall2","wall3","wall4","floor1","floor2","floor3","floor4","canvas","append","cast","cell","paint","draw","chunk","array","size","slice","chunks","join","Minimap","camera","sight","el","compass","getPlayerPos","playerX","playerY","buffer","row","rowIndex","split","col","colIndex","Game","minimap","fps","loop","lastTime","requestAnimationFrame","animate","time","delta","update","render","OVERLAY_ID","OldModule","module","bundle","Module","moduleName","call","hot","data","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","event","JSON","parse","type","handled","assets","forEach","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","id","every","generated","js","console","clear","hmrApply","v","hmrAcceptRun","window","reload","close","onclose","log","removeErrorOverlay","error","message","stack","overlay","createErrorOverlay","getElementById","remove","stackTrace","innerText","getParents","modules","parents","k","dep","isArray","concat","Function","deps","cached","cache","some","cb"],"mappings":"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","file":"src.a2b27638.js","sourceRoot":"..","sourcesContent":["const codes = { 37: 'left', 39: 'right', 38: 'forward', 40: 'backward' }\nconst state = { left: false, right: false, forward: false, backward: false }\n\nfunction onKey (pressed, direction) {\n  if (!direction) {\n    return\n  }\n\n  state[direction] = pressed\n}\n\ndocument.addEventListener('keydown', ({ which }) => onKey(true, codes[which]))\ndocument.addEventListener('keyup', ({ which }) => onKey(false, codes[which]))\n\nexport default state\n","const circle = Math.PI * 2\n\nexport default class Player {\n  constructor (x, y, direction) {\n    this.x = x\n    this.y = y\n    this.speed = 10\n    this.rotateSpeed = Math.PI * 2\n    this.direction = direction\n\n    this.init()\n  }\n\n  init () {\n    this.info = document.createElement('div')\n    this.info.classList.add('player-info')\n\n    document.body.appendChild(this.info)\n  }\n\n  rotate (angle) {\n    this.direction = (this.direction + angle + circle) % circle\n  }\n\n  move (distance, map) {\n    const dx = Math.cos(this.direction) * distance\n    const dy = Math.sin(this.direction) * distance\n\n    if (!map.isWall(this.x + dx, this.y)) this.x += dx\n    if (!map.isWall(this.x, this.y + dy)) this.y += dy\n  }\n\n  update (controls, map, tick) {\n    if (controls.left) this.rotate(-this.rotateSpeed * tick)\n    if (controls.right) this.rotate(this.rotateSpeed * tick)\n    if (controls.forward) this.move((this.speed * tick), map)\n    if (controls.backward) this.move(-(this.speed * tick), map)\n\n    this.updateInfo(controls)\n  }\n\n  updateInfo ({ left, right, forward, backward }) {\n    this.info.innerHTML = `\n      x: ${this.x.toFixed(2)};\n      y: ${this.y.toFixed(2)};\n      r: ${this.direction.toFixed(2)}rad;\n      L: ${left};\n      R: ${right};\n      F: ${forward};\n      B: ${backward}\n    `\n  }\n}\n","export default class Map {\n  constructor () {\n    this.walls = [\n      '###############',\n      '#.............#',\n      '#.............#',\n      '#.............#',\n      '#..........####',\n      '#.............#',\n      '#.............#',\n      '#.............#',\n      '#.............#',\n      '#.......###...#',\n      '#.............#',\n      '#.............#',\n      '#.............#',\n      '###############'\n    ]\n\n    this.width = this.walls[0].length\n    this.height = this.walls.length\n    this.eyeshot = []\n    this.charSet = {\n      wall: '#',\n      floor: '.'\n    }\n  }\n\n  get (x, y) {\n    x = Math.floor(x)\n    y = Math.floor(y)\n\n    if (x < 0 || x > this.width - 1 || y < 0 || y > this.height - 1) {\n      return -1\n    }\n\n    return this.walls[y][x]\n  }\n\n  isWall (x, y) {\n    const char = this.get(x, y)\n    return char === this.charSet.wall\n  }\n\n  cast (player, angle, depth) {\n    const sin = Math.sin(angle)\n    const cos = Math.cos(angle)\n\n    let distance = 0\n    let hitWall = false\n    let boundary = false\n\n    while (!hitWall && distance < depth) {\n      distance += 1\n      const nTestX = Math.floor(player.x + cos * distance)\n      const nTestY = Math.floor(player.y + sin * distance)\n\n      this.eyeshot[nTestY] = this.eyeshot[nTestY] || []\n      this.eyeshot[nTestY][nTestX] = true\n\n      if (nTestX < 0 || nTestX >= this.width || nTestY < 0 || nTestY >= this.height) {\n        distance = depth\n        hitWall = true\n      } else {\n        if (this.walls[nTestY][nTestX] === this.charSet.wall) {\n          hitWall = true\n\n          const p = []\n\n          for (let tx = 0; tx < 2; tx++) {\n            for (let ty = 0; ty < 2; ty++) {\n              const vy = nTestX + tx - player.x\n              const vx = nTestY + ty - player.y\n              const d = Math.hypot(vx, vy)\n              const dot = (sin * vx / d) + (cos * vy / d)\n              p.push([d, dot])\n            }\n          }\n\n          const bound = 0.01\n          const sorted = p.sort((a, b) => a[0] < b[0])\n\n          if (Math.acos(sorted[0][1]) < bound) boundary = true\n          if (Math.acos(sorted[1][1]) < bound) boundary = true\n          if (Math.acos(sorted[2][1]) < bound) boundary = true\n        }\n      }\n    }\n\n    // remove fisheye effect\n    distance *= Math.cos(angle - player.direction)\n\n    return { distance, boundary }\n  }\n}","export default class Camera {\n  constructor (map, player) {\n    this.map = map\n    this.player = player\n    this.width = 250\n    this.height = 80\n    this.depth = 14\n    this.fov = 45 * (Math.PI  / 180)\n    this.screen = new Array(this.width * this.height)\n    this.charSet = {\n      ceiling: ' ',\n      boundary: ' ',\n      wall1: 'â–ˆ',\n      wall2: 'â–“',\n      wall3: 'â–’',\n      wall4: 'â–‘',\n      floor1: '#',\n      floor2: 'x',\n      floor3: '.',\n      floor4: '-'\n    }\n\n    this.init()\n  }\n\n  init () {\n    this.canvas = document.createElement('div')\n    this.canvas.classList.add('camera')\n\n    document.body.append(this.canvas)\n  }\n\n  // Big thanks to [Javidx9](https://github.com/OneLoneCoder) for this simple solution\n  render () {\n    // reset sight\n    this.map.eyeshot = []\n\n    for (let x = 0; x < this.width; x++) {\n      const angle = (this.player.direction - this.fov / 2) + (x / this.width) * this.fov\n      const { distance, boundary } = this.map.cast(this.player, angle, this.depth)\n\n      // calc ceiling and floor height\n      const ceiling = (this.height / 2) - this.height / distance\n      const floor = this.height - ceiling\n\n      for (let y = 0; y < this.height; y++) {\n        const cell = y * this.width + x\n        let paint = ' '\n\n        if (y <= ceiling) {\n          // ceiling\n          paint = this.charSet.ceiling\n        } else if (y > ceiling && y <= floor) {\n          // wall\n          if (distance <= this.depth / 4)     paint = this.charSet.wall1 // very close\n          else if (distance < this.depth / 3) paint = this.charSet.wall2\n          else if (distance < this.depth / 2) paint = this.charSet.wall3\n          else if (distance < this.depth)     paint = this.charSet.wall4 // far\n          else paint = ' '\n\n          if (boundary) paint = this.charSet.boundary\n        } else {\n          // floot\n          const b = 1 - (y - this.height / 2) / (this.height / 2)\n\n\t\t\t\t\tif (b < 0.25) paint = this.charSet.floor1\n\t\t\t\t\telse if (b < 0.5)\t paint = this.charSet.floor2\n\t\t\t\t\telse if (b < 0.75) paint = this.charSet.floor3\n          else if (b < 0.9)\t paint = this.charSet.floor4\n          else paint = ' '\n        }\n\n        this.screen[cell] = paint\n      }\n    }\n\n    this.draw()\n  }\n\n  draw () {\n    const chunk = (array = [], size) => array.length ? [array.slice(0, size), ...chunk(array.slice(size), size)] : []\n    const chunks = chunk(this.screen, this.width)\n\n    // draw buffer\n    this.canvas.innerHTML = chunks.map(chunk => chunk.join('')).join('<br/>')\n  }\n}","export default class Minimap {\n  constructor (map, player, camera) {\n    this.map = map\n    this.player = player\n    this.charSet = {\n      player: 'P',\n      wall: '#',\n      floor: '.',\n      sight: ' '\n    }\n\n    this.init()\n  }\n\n  init () {\n    this.el = document.createElement('pre')\n    this.el.classList.add('minimap')\n\n    this.compass = document.createElement('div')\n    this.compass.classList.add('compass')\n\n    document.body.appendChild(this.el)\n    document.body.appendChild(this.compass)\n  }\n\n  getPlayerPos () {\n    return {\n      x: Math.floor(this.player.x),\n      y: Math.floor(this.player.y)\n    }\n  }\n\n  update () {\n    const { x: playerX, y: playerY } = this.getPlayerPos()\n    const buffer = this.map.walls.map((row, rowIndex) => {\n      return row.split('').map((col, colIndex) => {\n        // player\n        if (colIndex === playerX && rowIndex === playerY) {\n          return this.charSet.player\n        }\n\n        // wall\n        if (col === this.map.charSet.wall) {\n          return this.charSet.wall\n        }\n\n        // eyesight\n        if (this.map.eyeshot[rowIndex] && this.map.eyeshot[rowIndex][colIndex]) {\n          return this.charSet.sight\n        }\n        \n        // floor\n        return this.charSet.floor\n      }).join('')\n    }).join('\\n')\n\n    this.el.innerHTML = buffer\n  }\n}\n","import controls from './controls'\nimport Player from './player'\nimport Map from './map'\nimport Camera from './camera'\nimport Minimap from './minimap'\n\nfunction Game () {\n  const map = new Map()\n  const player = new Player(2, 1, Math.PI * 0.5)\n  const camera = new Camera(map, player)\n  const minimap = new Minimap(map, player, camera)\n  const fps = 30\n  \n  function loop () {\n    let lastTime = null\n\n    requestAnimationFrame(function animate (time) {\n      requestAnimationFrame(animate)\n      const delta = time - lastTime\n      const tick = (time - lastTime) / 1000\n      lastTime = time\n  \n      if (delta > lastTime % (1000 / fps)) {\n        player.update(controls, map, tick)\n        camera.render(player, map)\n        minimap.update()\n      }\n    })\n  }\n  \n  loop()\n}\n\ndocument.addEventListener('DOMContentLoaded', () => new Game())\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else {\n        window.location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel] âœ¨ Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel] ðŸš¨  ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\">ðŸš¨</span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}